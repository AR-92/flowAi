<!-- Environment Variables Management Page Container - Black Background -->
<div class="flex flex-col h-full bg-black text-gray-200 pt-6 pr-16 pl-6">
    <!-- Base text lighter -->

    <!-- Header Section -->
    <div
        class="flex justify-between items-center mb-6 border-b border-gray-700 pb-4"
    >
        <!-- Lighter border -->
        <h3 class="text-lg font-medium text-gray-100">
            Manage Environment Variables & Secrets
        </h3>
        <!-- Brighter title -->
        <button
            id="add-variable-btn"
            class="flex items-center bg-blue-600 hover:bg-blue-500 text-white text-xs font-semibold px-3 py-1.5 rounded transition duration-150"
        >
            <svg
                xmlns="http://www.w3.org/2000/svg"
                width="14"
                height="14"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="lucide lucide-plus mr-1"
            >
                <path d="M5 12h14" />
                <path d="M12 5v14" />
            </svg>
            Add New Variable
        </button>
    </div>

    <!-- Table Section - Scrollable -->
    <div class="flex-grow overflow-y-auto max-h-[calc(100vh-10rem)]">
        <table class="w-full text-sm text-left text-gray-300">
            <!-- Default table text lighter -->
            <thead
                class="text-xs text-gray-400 uppercase bg-gray-900 sticky top-0"
            >
                <!-- Header text lighter -->
                <tr>
                    <th scope="col" class="px-4 py-3">Key</th>
                    <th scope="col" class="px-4 py-3">Value</th>
                    <th scope="col" class="px-4 py-3">Type</th>
                    <th scope="col" class="px-4 py-3 text-right">Actions</th>
                </tr>
            </thead>
            <tbody id="variables-table-body" class="divide-y divide-gray-700">
                <!-- Lighter divider -->
                <!-- Placeholder Row 1: Environment Variable -->
                <tr class="hover:bg-gray-800 transition-colors duration-150">
                    <!-- Adjusted hover -->
                    <td class="px-4 py-3 font-mono text-gray-200">
                        API_ENDPOINT
                    </td>
                    <!-- Lighter text -->
                    <td class="px-4 py-3 font-mono text-gray-200">
                        https://api.example.com/v1
                    </td>
                    <!-- Lighter text -->
                    <td class="px-4 py-3">
                        <span
                            class="bg-gray-700 text-gray-200 text-[10px] font-medium px-2 py-0.5 rounded"
                            >Env Var</span
                        >
                    </td>
                    <!-- Lighter badge text -->
                    <td class="px-4 py-3 text-right space-x-2">
                        <button
                            class="text-blue-400 hover:text-blue-300"
                            title="Edit"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                width="14"
                                height="14"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                class="inline-block"
                            >
                                <path
                                    d="M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"
                                />
                                <path d="m15 5 4 4" />
                            </svg>
                        </button>
                        <button
                            class="text-red-500 hover:text-red-400"
                            title="Delete"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                width="14"
                                height="14"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                class="inline-block"
                            >
                                <path d="M3 6h18" />
                                <path
                                    d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"
                                />
                                <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" />
                                <line x1="10" x2="10" y1="11" y2="17" />
                                <line x1="14" x2="14" y1="11" y2="17" />
                            </svg>
                        </button>
                    </td>
                </tr>
                <!-- Placeholder Row 2: Secret Key (Masked) -->
                <tr class="hover:bg-gray-800 transition-colors duration-150">
                    <!-- Adjusted hover -->
                    <td class="px-4 py-3 font-mono text-gray-200">
                        STRIPE_SECRET_KEY
                    </td>
                    <!-- Lighter text -->
                    <td class="px-4 py-3 font-mono text-gray-400">
                        ••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••
                    </td>
                    <!-- Lighter masked text -->
                    <td class="px-4 py-3">
                        <span
                            class="bg-purple-800 text-purple-200 text-[10px] font-medium px-2 py-0.5 rounded"
                            >Secret</span
                        >
                    </td>
                    <!-- Adjusted badge bg -->
                    <td class="px-4 py-3 text-right space-x-2">
                        <button
                            class="text-cyan-400 hover:text-cyan-300"
                            title="Reveal Value"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                width="14"
                                height="14"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                class="inline-block"
                            >
                                <path
                                    d="M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"
                                />
                                <circle cx="12" cy="12" r="3" />
                            </svg>
                        </button>
                        <!-- Brighter reveal button -->
                        <button
                            class="text-blue-400 hover:text-blue-300"
                            title="Edit"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                width="14"
                                height="14"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                class="inline-block"
                            >
                                <path
                                    d="M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"
                                />
                                <path d="m15 5 4 4" />
                            </svg>
                        </button>
                        <button
                            class="text-red-500 hover:text-red-400"
                            title="Delete"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                width="14"
                                height="14"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                class="inline-block"
                            >
                                <path d="M3 6h18" />
                                <path
                                    d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"
                                />
                                <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" />
                                <line x1="10" x2="10" y1="11" y2="17" />
                                <line x1="14" x2="14" y1="11" y2="17" />
                            </svg>
                        </button>
                    </td>
                </tr>
                <!-- Placeholder Row 3: Credential -->
                <tr class="hover:bg-gray-800 transition-colors duration-150">
                    <!-- Adjusted hover -->
                    <td class="px-4 py-3 font-mono text-gray-200">
                        DB_USERNAME
                    </td>
                    <!-- Lighter text -->
                    <td class="px-4 py-3 font-mono text-gray-200">
                        admin_user
                    </td>
                    <!-- Lighter text -->
                    <td class="px-4 py-3">
                        <span
                            class="bg-yellow-800 text-yellow-200 text-[10px] font-medium px-2 py-0.5 rounded"
                            >Credential</span
                        >
                    </td>
                    <!-- Adjusted badge bg -->
                    <td class="px-4 py-3 text-right space-x-2">
                        <button
                            class="text-blue-400 hover:text-blue-300"
                            title="Edit"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                width="14"
                                height="14"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                class="inline-block"
                            >
                                <path
                                    d="M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"
                                />
                                <path d="m15 5 4 4" />
                            </svg>
                        </button>
                        <button
                            class="text-red-500 hover:text-red-400"
                            title="Delete"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                width="14"
                                height="14"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                class="inline-block"
                            >
                                <path d="M3 6h18" />
                                <path
                                    d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"
                                />
                                <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" />
                                <line x1="10" x2="10" y1="11" y2="17" />
                                <line x1="14" x2="14" y1="11" y2="17" />
                            </svg>
                        </button>
                    </td>
                </tr>
                <!-- Placeholder Row 4: Credential (Password - Masked) -->
                <tr class="hover:bg-gray-800 transition-colors duration-150">
                    <!-- Adjusted hover -->
                    <td class="px-4 py-3 font-mono text-gray-200">
                        DB_PASSWORD
                    </td>
                    <!-- Lighter text -->
                    <td class="px-4 py-3 font-mono text-gray-400">
                        ••••••••••••••••
                    </td>
                    <!-- Lighter masked text -->
                    <td class="px-4 py-3">
                        <span
                            class="bg-yellow-800 text-yellow-200 text-[10px] font-medium px-2 py-0.5 rounded"
                            >Credential</span
                        >
                    </td>
                    <!-- Adjusted badge bg -->
                    <td class="px-4 py-3 text-right space-x-2">
                        <button
                            class="text-cyan-400 hover:text-cyan-300"
                            title="Reveal Value"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                width="14"
                                height="14"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                class="inline-block"
                            >
                                <path
                                    d="M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"
                                />
                                <circle cx="12" cy="12" r="3" />
                            </svg>
                        </button>
                        <!-- Brighter reveal button -->
                        <button
                            class="text-blue-400 hover:text-blue-300"
                            title="Edit"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                width="14"
                                height="14"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                class="inline-block"
                            >
                                <path
                                    d="M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"
                                />
                                <path d="m15 5 4 4" />
                            </svg>
                        </button>
                        <button
                            class="text-red-500 hover:text-red-400"
                            title="Delete"
                        >
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                width="14"
                                height="14"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                class="inline-block"
                            >
                                <path d="M3 6h18" />
                                <path
                                    d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"
                                />
                                <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" />
                                <line x1="10" x2="10" y1="11" y2="17" />
                                <line x1="14" x2="14" y1="11" y2="17" />
                            </svg>
                        </button>
                    </td>
                </tr>
                <!-- Add more rows dynamically here -->
                <tr class="bg-gray-900">
                    <!-- Adjusted bg -->
                    <td
                        colspan="4"
                        class="px-4 py-6 text-center text-gray-500 text-sm"
                    >
                        <!-- Lighter text -->
                        No more variables found.
                        <a
                            href="#"
                            id="add-variable-link"
                            class="text-blue-400 hover:text-blue-300"
                            >Add a new one?</a
                        >
                        <!-- Adjusted link color -->
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Modal Placeholder (Hidden by default) -->
    <div
        id="variable-modal"
        class="fixed inset-0 bg-black bg-opacity-85 flex items-center justify-center hidden z-50"
    >
        <!-- Darker overlay -->
        <div
            class="bg-gray-900 rounded-lg shadow-xl p-6 w-full max-w-md border border-gray-700"
        >
            <div class="flex justify-between items-center mb-4">
                <h4 id="modal-title" class="text-lg font-medium text-gray-100">
                    Add New Variable
                </h4>
                <!-- Brighter title -->
                <button
                    id="close-modal-btn"
                    class="text-gray-400 hover:text-gray-200 text-2xl leading-none"
                >
                    &times;
                </button>
                <!-- Lighter close button -->
            </div>
            <form id="variable-form">
                <input type="hidden" id="variable-id" />
                <!-- For editing -->
                <div class="mb-4">
                    <label
                        for="variable-key"
                        class="block text-sm font-medium text-gray-300 mb-1"
                        >Key</label
                    >
                    <!-- Lighter label -->
                    <input
                        type="text"
                        id="variable-key"
                        name="key"
                        required
                        class="w-full bg-gray-800 border border-gray-600 rounded px-3 py-2 text-sm text-gray-100 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 placeholder-gray-400"
                        placeholder="e.g., DATABASE_URL"
                    />
                    <!-- Lighter text/placeholder, adjusted border -->
                </div>
                <div class="mb-4">
                    <label
                        for="variable-value"
                        class="block text-sm font-medium text-gray-300 mb-1"
                        >Value</label
                    >
                    <!-- Lighter label -->
                    <textarea
                        id="variable-value"
                        name="value"
                        required
                        rows="3"
                        class="w-full bg-gray-800 border border-gray-600 rounded px-3 py-2 text-sm text-gray-100 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 placeholder-gray-400"
                        placeholder="Enter the value"
                    ></textarea>
                    <!-- Lighter text/placeholder, adjusted border -->
                </div>
                <div class="mb-6">
                    <label
                        for="variable-type"
                        class="block text-sm font-medium text-gray-300 mb-1"
                        >Type</label
                    >
                    <!-- Lighter label -->
                    <select
                        id="variable-type"
                        name="type"
                        required
                        class="w-full bg-gray-800 border border-gray-600 rounded px-3 py-2 text-sm text-gray-100 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"
                    >
                        <!-- Lighter text, adjusted border -->
                        <option value="env_var" class="bg-gray-800">
                            Environment Variable
                        </option>
                        <!-- Adjusted option bg -->
                        <option value="credential" class="bg-gray-800">
                            Credential
                        </option>
                        <!-- Adjusted option bg -->
                        <option value="secret" class="bg-gray-800">
                            Secret Key
                        </option>
                        <!-- Adjusted option bg -->
                    </select>
                </div>
                <div class="flex justify-end space-x-3">
                    <button
                        type="button"
                        id="cancel-modal-btn"
                        class="bg-gray-700 hover:bg-gray-600 text-gray-200 text-sm font-medium px-4 py-2 rounded transition duration-150"
                    >
                        Cancel
                    </button>
                    <!-- Lighter text -->
                    <button
                        type="submit"
                        id="save-variable-btn"
                        class="bg-blue-600 hover:bg-blue-500 text-white text-sm font-medium px-4 py-2 rounded transition duration-150"
                    >
                        Save Variable
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- End Environment Variables Management Page Container -->

<!-- Basic JS for Modal Interaction (Example) -->
<script>
    (function () {
        const addBtn = document.getElementById("add-variable-btn");
        const addLink = document.getElementById("add-variable-link");
        const modal = document.getElementById("variable-modal");
        const closeModalBtn = document.getElementById("close-modal-btn");
        const cancelModalBtn = document.getElementById("cancel-modal-btn");
        const modalTitle = document.getElementById("modal-title");
        const variableForm = document.getElementById("variable-form");
        const variableIdInput = document.getElementById("variable-id");
        const variableKeyInput = document.getElementById("variable-key");
        const variableValueInput = document.getElementById("variable-value");
        const variableTypeInput = document.getElementById("variable-type");
        const tableBody = document.getElementById("variables-table-body");

        function openModal(mode = "add", data = {}) {
            variableForm.reset(); // Clear previous data
            if (mode === "edit") {
                modalTitle.textContent = "Edit Variable";
                variableIdInput.value = data.id || ""; // Assuming an ID exists for editing
                variableKeyInput.value = data.key || "";
                variableValueInput.value = data.value || "";
                variableTypeInput.value = data.type || "env_var";
                // Potentially disable key editing: variableKeyInput.disabled = true;
            } else {
                modalTitle.textContent = "Add New Variable";
                variableIdInput.value = "";
                // variableKeyInput.disabled = false;
            }
            modal.classList.remove("hidden");
        }

        function closeModal() {
            modal.classList.add("hidden");
        }

        // Event Listeners
        if (addBtn) addBtn.addEventListener("click", () => openModal("add"));
        if (addLink)
            addLink.addEventListener("click", (e) => {
                e.preventDefault();
                openModal("add");
            });
        if (closeModalBtn) closeModalBtn.addEventListener("click", closeModal);
        if (cancelModalBtn)
            cancelModalBtn.addEventListener("click", closeModal);

        // Close modal if clicking outside the form container
        if (modal) {
            modal.addEventListener("click", (event) => {
                if (event.target === modal) {
                    closeModal();
                }
            });
        }

        // Handle form submission (Placeholder)
        if (variableForm) {
            variableForm.addEventListener("submit", (event) => {
                event.preventDefault();
                const id = variableIdInput.value;
                const key = variableKeyInput.value;
                const value = variableValueInput.value;
                const type = variableTypeInput.value;

                console.log("Form Submitted:", { id, key, value, type });
                // TODO: Implement actual API call to save/update the variable
                // On success:
                // - Update the table (add new row or modify existing)
                // - Close the modal
                alert(
                    "Variable " +
                        (id ? "updated" : "added") +
                        " (simulated): " +
                        key,
                );
                closeModal();
            });
        }

        // Handle table actions (Placeholder for Edit/Delete/Reveal)
        if (tableBody) {
            tableBody.addEventListener("click", (event) => {
                const target = event.target;
                const row = target.closest("tr");
                if (!row) return;

                const key = row.cells[0].textContent;
                const value = row.cells[1].textContent; // Might be masked
                const type = row.cells[2]
                    .querySelector("span")
                    .textContent.toLowerCase()
                    .replace(" ", "_"); // Infer type

                // Check based on title attribute now
                const action = target.closest("button")?.title;

                if (action === "Edit") {
                    console.log("Edit clicked for:", key);
                    // TODO: Fetch full value if masked before opening modal
                    openModal("edit", {
                        key,
                        value: "FETCH_REAL_VALUE_IF_MASKED",
                        type,
                    }); // Pass data to modal
                } else if (action === "Delete") {
                    console.log("Delete clicked for:", key);
                    if (
                        confirm(
                            'Are you sure you want to delete the variable "' +
                                key +
                                '"?',
                        )
                    ) {
                        // TODO: Implement actual API call to delete the variable
                        alert('Variable "' + key + '" deleted (simulated).');
                        row.remove(); // Remove row from table
                    }
                } else if (action === "Reveal Value") {
                    console.log("Reveal clicked for:", key);
                    // TODO: Implement logic to fetch and display the real value
                    alert('Reveal action for "' + key + '" (not implemented).');
                    // Example: Replace masked value or show in a temporary tooltip/modal
                    // row.cells[1].textContent = 'REVEALED_VALUE';
                    // target.textContent = 'Hide'; // Toggle button
                }
            });
        }
    })();
</script>
